                    README for Pacman on Mac OS X

These are notes for compiling and installing pacman on Mac OS X. This has
only been tested on Mac OS X Mountain Lion. At the moment no code patches
are necessary so these notes are mostly for managing missing dependencies.

A small (but growing) repo of OS X compatible packages are located at:

     http://github.com/kladd/pacman-osx-pkgs

DOWNLOADING:

  Download the source code with git:

     git clone git://projects.archlinux.org/pacman.git

REQUIREMENTS:

 - bash 4.2.042 or greater

   The default bash version in Mac OS X Mountain Lion is 3.2.48, you will
   need to install 4.2.042 or greater to compile pacman.

   Compile and install bash to a directory of your choice
   (I use /usr/local) and add the newly installed bash binary to
   /etc/shells.

   Change your default shell to the new bash

     chsh -c /path/to/bin/bash

 - libarchive 2.8.0 or greater

   Mac OS X Mountain Lion ships with libarchive 2.8.3, but this installation
   does not include headers required by pacman.

   You may want to check your version of libarchive first:

     tar --version

   In the following steps, use this version provided it is later than 2.8.0

   Clone the libarchive git repo and build the tag that corresponds to your
   libarchive version.

     git clone https://github.com/libarchive/libarchive.git
     cd libarchive
     git checkout v2.8.3

     build/autogen.sh
     ./configure --prefix=/opt/libarchive
     make && make install

 - asciidoc

   Install. Command required: a2x

COMPILING:

  Generate configure script

     ./autoclean.sh
     ./autogen.sh

  Set environment variables to point to libarchive headers

     export LIBARCHIVE_CFLAGS="-I/opt/libarchive/include"
     export LIBARCHIVE_LIBS="-larchive"
     export LIBCURL_CFLAGS="-I/usr/include/curl"
     export LIBCURL_LIBS="-lcurl"

  Set asciidoc XML_CATALOG_FILES environment variable

     export XML_CATALOG_FILES=/path/to/xml/catalog # from asciidoc

  Configure and make

     # replace /usr/local/bin/bash with the location of your bash >= 4.2.042
     ./configure --prefix=/usr/local \
                 --enable-doc \
                 --with-scriptlet-shell=/usr/local/bin/bash \
                 --with-ldconfig=/usr/local/bin/ldconfig \
                 --with-curl
     make
     make -C contrib
     make install
     make -C contrib install
